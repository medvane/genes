<h1><%= @gene.to_s %></h1>
<ul>
  <li>Name: <%= @gene.name %> (<%= link_to("Entrez Gene record", "http://www.ncbi.nlm.nih.gov/gene/" + @gene.id.to_s, :target => "_blank")%>)</li>
  <li>Chromosome: <%= @gene.chromosome %></li>
  <li>Map location: <%= @gene.map_location %></li>
  <li><%= link_to(pluralize(number_with_delimiter(@gene.articles_count), "article") + " in PubMed", "http://www.ncbi.nlm.nih.gov/sites/entrez?Db=pubmed&DbFrom=gene&Cmd=Link&LinkName=gene_pubmed&LinkReadableName=PubMed&IdsFromResult=#{@gene.id}", :target => "_blank") %></li>
</ul>
<div id="subjects">
  <h2>Top Subjects</h2>
  <table>
    <tr>
      <th>Subject</th>
      <th>Articles</th>
    </tr>
    <% @gene.gene_subjects.each do |s| %>
    <tr>
      <td><%= s.subject.term %> <%= semantic_groups(s.subject) %></td>
      <td class="number"><%= number_with_delimiter(s.articles_count) %></td>
    </tr>
    <% end %>
  </table>
</div>
<% if @gene.reviewed_genes.size > 0 %>
<div id="reviews">
<h2>Reviews</h2>
<table>
  <tr>
    <th>Title</th>
    <th>Articles</th>
  </tr>
<% for r in @gene.reviewed_genes %>
  <tr>
    <td><%= link_to(r.review.title, review_path(r.review)) %></td>
    <td class="number"><%= number_with_delimiter(r.articles_count)%></td>
  </tr>
<% end %>
</table>
</div>
<% end %>
<% if @gene.homologs.size > 0 %>
<div id="homologs">
  <h2>Homologs from <%= link_to("NCBI HomoloGene", "http://www.ncbi.nlm.nih.gov/homologene/#{@gene.homologene.homolog_id}", :target => "_blank")%></h2>
  <table>
    <tr>
      <th>Species</th>
      <th>Gene</th>
      <th>Reviews</th>
    </tr>
<% for h in @gene.homologs %>
    <tr>
      <td><%= h.taxonomy.scientific_name %></td>
      <td><%= link_to(h.symbol, gene_path(h), :title => h.name)%></td>
      <td><% if h.reviewed_genes.size > 0 %><%= h.reviewed_genes.map {|hr| link_to(hr.review.title, review_path(hr.review)) + " (#{pluralize(hr.articles_count, "article")})"}.join("<br>\n").html_safe %><% end %></td>
    </tr>
  <% end %>
  </table>
</div>
<% end %>